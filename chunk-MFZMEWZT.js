import{a as ot,b as pt}from"./chunk-EXM7WT6R.js";import{a as J,b as Q}from"./chunk-NO7XN4JG.js";import{a as it,b as nt,c as st,d as ct}from"./chunk-DCIHQSYU.js";import{b as rt}from"./chunk-UNBJV5AW.js";import"./chunk-S3CE4ME5.js";import{d as G}from"./chunk-JOQRKRUQ.js";import{a as b}from"./chunk-7W45JCHE.js";import"./chunk-43IZR5HA.js";import{C as Z,Ha as et,ea as tt,v as V,x as W,y as X}from"./chunk-VZCMWG7S.js";import{i as z,j as K}from"./chunk-7JHFUFAC.js";import{$b as M,Cb as L,Db as k,Eb as C,Fb as m,Gb as l,Hb as S,Ob as w,Wa as s,Wb as $,Xb as R,Zb as d,_b as U,a as F,b as D,cc as P,dc as q,ec as H,gc as j,hb as h,hc as r,ic as c,jc as Y,ka as g,kb as u,kc as T,pc as v,tc as N,x as E}from"./chunk-LK5URRF6.js";function mt(e,t){let n=parseInt(e,10),o=(Math.sign(n)||1)*Math.abs(t)/1e9;return n+o}var at=(()=>{let t=class t{transform(i){return nt(i)}};t.\u0275fac=function(o){return new(o||t)},t.\u0275pipe=u({name:"tuiAutoColor",type:t,pure:!0});let e=t;return e})();var ut=(()=>{let t=class t{transform(i){return i.toUpperCase().split(" ").map(([o])=>o).join("").slice(0,2)}};t.\u0275fac=function(o){return new(o||t)},t.\u0275pipe=u({name:"tuiInitials",type:t,pure:!0});let e=t;return e})();var gt={currency:null,currencyAlign:"left",sign:"negative-only"},Pt=Z(gt);function vt(e,t){return t==="never"||!e||t==="negative-only"&&e>0?"":t==="force-negative"||e<0&&t!=="force-positive"?W:X}var xt=2,lt=(()=>{let t=class t{constructor(){this.options=g(Pt),this.format=g(et)}transform(i,o=this.options.currency,p=this.options.currencyAlign){return this.format.pipe(E(y=>{let a=st(o),f=it(Math.abs(i),D(F({},y),{precision:Number.isNaN(y.precision)?xt:y.precision})),x=f==="0"?"":vt(i,this.options.sign),_=a&&(a?.length>1||p==="right")?V:"";return p==="right"?`${x}${f}${_}${a}`:`${x}${a}${_}${f}`}))}};t.\u0275fac=function(o){return new(o||t)},t.\u0275pipe=u({name:"tuiAmount",type:t,pure:!0});let e=t;return e})();var It=e=>[e],A=class e{position=N.required();instrument=N();combinePrice=mt;quantityUnits=v(()=>Number(this.position().quantity.units));logoUrl=v(()=>{let t=this.instrument()?.brand;return t?pt(t):null});static \u0275fac=function(n){return new(n||e)};static \u0275cmp=h({type:e,selectors:[["app-position-item"]],inputs:{position:[1,"position"],instrument:[1,"instrument"]},decls:29,vars:45,consts:[["tuiAppearance","floating","tuiCardMedium","",1,"card",3,"routerLink"],[1,"avatar",3,"src"],[1,"content"],["tuiTitle","",1,"card__name"],[1,"current-price"],[1,"price"],[1,"expected-yield"]],template:function(n,i){if(n&1&&(P(0),r(1,"uppercase"),r(2,"tuiCurrency"),P(3),r(4,"tuiInitials"),m(5,"div",0),S(6,"tui-avatar",1),r(7,"tuiAutoColor"),m(8,"div",2)(9,"h2",3),d(10),l(),m(11,"div")(12,"span"),d(13),r(14,"tuiAmount"),r(15,"async"),l(),m(16,"span",4),d(17),r(18,"tuiAmount"),r(19,"async"),l()()(),m(20,"div",5)(21,"div"),d(22),r(23,"tuiAmount"),r(24,"async"),l(),m(25,"div",6),d(26),r(27,"tuiAmount"),r(28,"async"),l()()()),n&2){let o,p=i.position(),y=i.combinePrice(p.currentPrice.units,p.currentPrice.nano),a=i.combinePrice(p.expectedYield.units,p.expectedYield.nano),f=c(2,15,c(1,13,p.currentPrice.currency)),x=i.quantityUnits(),_=x*y,B=i.logoUrl(),ft=B||c(4,17,p.ticker),yt=((o=i.instrument())==null?null:o.name)??p.ticker;s(5),C("routerLink",j(43,It,p.ticker)),s(),$("background",c(7,19,p.ticker)),C("src",ft),s(4),M(" ",yt," "),s(3),M("",c(15,23,c(14,21,x))," \u0448\u0442."),s(4),U(c(19,29,T(18,25,y,f,"right"))),s(5),U(c(24,35,T(23,31,_,f,"right"))),s(3),R("expected-yield_negative",a<0)("expected-yield_positive",a>0),s(),M("",c(28,41,T(27,37,a,f,"right"))," ")}},dependencies:[G,rt,tt,b,ot,at,ut,ct,K,lt,z],styles:[".card[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:row;align-items:center;block-size:auto;gap:10px;cursor:pointer}.avatar[_ngcontent-%COMP%]{display:flex}.content[_ngcontent-%COMP%]{display:flex;flex-flow:column;flex-grow:1;gap:6px}.price[_ngcontent-%COMP%]{display:flex;flex-flow:column;align-items:flex-end;gap:6px}.current-price[_ngcontent-%COMP%]{margin-left:8px}.expected-yield[_ngcontent-%COMP%]{top:-2px;position:relative;color:#888}.expected-yield_negative[_ngcontent-%COMP%]{color:#dc143c}.expected-yield_positive[_ngcontent-%COMP%]{color:#228b22}"]})};var O=class e{transform(t,n){return n.find(i=>i.uid===t.instrumentUid)}static \u0275fac=function(n){return new(n||e)};static \u0275pipe=u({name:"findInstrument",type:e,pure:!0})};var _t=(e,t)=>t.ticker;function ht(e,t){if(e&1&&(P(0),r(1,"findInstrument"),S(2,"app-position-item",1)),e&2){let n=t.$implicit;w();let i=H(0),o=Y(1,2,n,i);s(2),C("position",n)("instrument",o)}}var dt=class e{operationsService=g(J);instrumentsService=g(Q);positions=v(()=>this.operationsService.selectPortfolio()?.positions);positionShares=v(()=>this.positions()?.filter(t=>t.instrumentType==="share")||[]);instruments=this.instrumentsService.selectInstruments;constructor(){}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=h({type:e,selectors:[["app-positions"]],decls:5,vars:1,consts:[["tuiTitle","m",1,"title"],[3,"position","instrument"]],template:function(n,i){n&1&&(P(0),m(1,"h2",0),d(2,"\u041E\u0442\u043A\u0440\u044B\u0442\u044B\u0435 \u043F\u043E\u0437\u0438\u0446\u0438\u0438"),l(),L(3,ht,3,5,"app-position-item",1,_t)),n&2&&(q(i.instruments()),s(3),k(i.positionShares()))},dependencies:[A,O,b],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;gap:10px}.title[_ngcontent-%COMP%]{margin-bottom:10px}"]})};export{dt as PositionsComponent};
