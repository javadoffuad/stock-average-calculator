import{a as U}from"./chunk-TXLL62KM.js";import{a as E}from"./chunk-S3CE4ME5.js";import{C as D}from"./chunk-SAGZ5FPR.js";import{a as w}from"./chunk-V3XR5FTU.js";import{d as T,j as k}from"./chunk-R25DRIKW.js";import"./chunk-T5CIW55O.js";import"./chunk-3LIWCLF5.js";import{Ab as C,Bb as b,Cb as u,Db as r,Eb as c,Fb as d,Ua as n,Vb as S,Xb as s,Yb as _,Zb as A,_b as f,da as I,dc as M,fb as m,ia as a,lc as l,mc as h,pc as O,wa as y}from"./chunk-WTOALF4U.js";function F(e,t){let i=typeof e=="string"?parseInt(e,10):e,o=(Math.sign(i)||1)*Math.abs(t)/1e9;return i+o}var B=e=>[e],v=class e{position=O.required();combinePrice=F;static \u0275fac=function(i){return new(i||e)};static \u0275cmp=m({type:e,selectors:[["app-position-item"]],inputs:{position:[1,"position"]},decls:15,vars:15,consts:[[1,"position",3,"routerLink"],[1,"logo"],[1,"content"],[1,"name"],[1,"current-price"],[1,"price"]],template:function(i,p){if(i&1&&(r(0,"div",0),d(1,"div",1),r(2,"div",2)(3,"h3",3),s(4),c(),r(5,"div")(6,"span"),s(7),c(),r(8,"span",4),s(9),c()()(),r(10,"div",5)(11,"div"),s(12),c(),r(13,"div"),s(14),c()()()),i&2){let o=p.position(),$=p.combinePrice(o.currentPrice.units,o.currentPrice.nano),L=p.combinePrice(o.averagePositionPrice.units,o.averagePositionPrice.nano),P=p.combinePrice(o.expectedYield.units,o.expectedYield.nano),x=o.currentPrice.currency;u("routerLink",M(13,B,o.ticker)),n(4),_(o.ticker),n(3),A("",o.quantity.units," \u0448\u0442."),n(2),f("",$," ",x),n(3),f("",L," ",x),n(),S("expected-yield_red",P<0)("expected-yield_green",P>0),n(),f("",P," ",x)}},dependencies:[k],styles:[".position[_ngcontent-%COMP%]{display:flex;align-items:center;flex-flow:row;width:100%;padding:10px;border-bottom:1px solid #919191;gap:10px}.name[_ngcontent-%COMP%]{font-size:15px}.logo[_ngcontent-%COMP%]{display:flex;width:44px;height:44px;border-radius:50%;background:#919191}.content[_ngcontent-%COMP%]{display:flex;flex-flow:column;flex-grow:1}.price[_ngcontent-%COMP%]{display:flex;flex-flow:column;align-items:flex-end}.current-price[_ngcontent-%COMP%]{margin-left:8px}.expected-yield_red[_ngcontent-%COMP%]{color:#dc143c}.expected-yield_green[_ngcontent-%COMP%]{color:#228b22}"]})};var g=class e{serviceUrl=`${E}.UsersService/`;http=a(T);authService=a(w);accounts=y([]);currentAccount=l(()=>this.accounts().length?this.accounts()[0]:null);constructor(){}loadAccounts(){this.http.post(`${this.serviceUrl}GetAccounts`,{status:"ACCOUNT_STATUS_UNSPECIFIED"},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.authService.getAccessToken()}`}}).subscribe(t=>this.accounts.set(t.accounts))}static \u0275fac=function(i){return new(i||e)};static \u0275prov=I({token:e,factory:e.\u0275fac,providedIn:"root"})};var G=(e,t)=>t.ticker;function Y(e,t){if(e&1&&d(0,"app-position-item",1),e&2){let i=t.$implicit;u("position",i)}}var j=class e{usersService=a(g);operationsService=a(U);account=this.usersService.currentAccount;portfolio=this.operationsService.selectPortfolio;positions=l(()=>this.portfolio()?.positions);positionShares=l(()=>this.positions()?.filter(t=>t.instrumentType==="share"));constructor(){h(()=>{let t=this.account();console.log("account",t),t&&this.operationsService.loadPortfolio(t.id)}),h(()=>{console.log("operation",this.portfolio())})}ngOnInit(){this.usersService.loadAccounts()}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=m({type:e,selectors:[["app-positions"]],decls:4,vars:0,consts:[["tuiTitle","m"],[3,"position"]],template:function(i,p){i&1&&(r(0,"h2",0),s(1,"\u041E\u0442\u043A\u0440\u044B\u0442\u044B\u0435 \u043F\u043E\u0437\u0438\u0446\u0438\u0438"),c(),C(2,Y,1,1,"app-position-item",1,G)),i&2&&(n(2),b(p.positionShares()))},dependencies:[v,D],encapsulation:2})};export{j as PositionsComponent};
