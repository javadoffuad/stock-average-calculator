import{a as w,c as E,d as A,e as U}from"./chunk-JTC2XVPF.js";import{Ha as C,Ia as b,Ja as I,Ka as s,L as y,La as c,Ma as d,Q as a,Qa as _,Ra as p,Sa as S,Ta as M,Ua as f,aa as h,ab as l,bb as x,db as O,ma as r,ua as m}from"./chunk-AQTKR2JR.js";function k(o,e){let t=typeof o=="string"?parseInt(o,10):o,i=(Math.sign(t)||1)*Math.abs(e)/1e9;return t+i}var u=class o{position=O.required();combinePrice=k;static \u0275fac=function(t){return new(t||o)};static \u0275cmp=m({type:o,selectors:[["app-position-item"]],inputs:{position:[1,"position"]},decls:15,vars:12,consts:[[1,"position"],[1,"logo"],[1,"content"],[1,"name"],[1,"current-price"],[1,"price"]],template:function(t,n){if(t&1&&(s(0,"div",0),d(1,"div",1),s(2,"div",2)(3,"h3",3),p(4),c(),s(5,"div")(6,"span"),p(7),c(),s(8,"span",4),p(9),c()()(),s(10,"div",5)(11,"div"),p(12),c(),s(13,"div"),p(14),c()()()),t&2){let i=n.position(),j=n.combinePrice(i.currentPrice.units,i.currentPrice.nano),N=n.combinePrice(i.averagePositionPrice.units,i.averagePositionPrice.nano),v=n.combinePrice(i.expectedYield.units,i.expectedYield.nano),g=i.currentPrice.currency;r(4),S(i.ticker),r(3),M("",i.quantity.units," \u0448\u0442."),r(2),f("",j," ",g),r(3),f("",N," ",g),r(),_("expected-yield_red",v<0)("expected-yield_green",v>0),r(),f("",v," ",g)}},styles:[".position[_ngcontent-%COMP%]{display:flex;align-items:center;flex-flow:row;width:100%;padding:10px;border-bottom:1px solid #919191;gap:10px}.name[_ngcontent-%COMP%]{font-size:15px}.logo[_ngcontent-%COMP%]{display:flex;width:44px;height:44px;border-radius:50%;background:#919191}.content[_ngcontent-%COMP%]{display:flex;flex-flow:column;flex-grow:1}.price[_ngcontent-%COMP%]{display:flex;flex-flow:column;align-items:flex-end}.current-price[_ngcontent-%COMP%]{margin-left:8px}.expected-yield_red[_ngcontent-%COMP%]{color:#dc143c}.expected-yield_green[_ngcontent-%COMP%]{color:#228b22}"]})};var P=class o{serviceUrl=`${E}.OperationsService/`;http=a(w);token=a(A);portfolio=h(null);selectPortfolio=l(()=>this.portfolio());constructor(){}loadPortfolio(e,t="RUB"){this.http.post(`${this.serviceUrl}GetPortfolio`,{accountId:e,currency:t},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.token}`}}).subscribe(n=>this.portfolio.set(n))}static \u0275fac=function(t){return new(t||o)};static \u0275prov=y({token:o,factory:o.\u0275fac,providedIn:"root"})};var F=(o,e)=>e.ticker;function R(o,e){if(o&1&&d(0,"app-position-item",0),o&2){let t=e.$implicit;I("position",t)}}var T=class o{usersService=a(U);operationsService=a(P);account=this.usersService.currentAccount;portfolio=this.operationsService.selectPortfolio;positions=l(()=>this.portfolio()?.positions);positionShares=l(()=>this.positions()?.filter(e=>e.instrumentType==="share"));constructor(){x(()=>{let e=this.account();console.log("account",e),e&&this.operationsService.loadPortfolio(e.id)}),x(()=>{console.log("operation",this.portfolio())})}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=m({type:o,selectors:[["app-positions"]],decls:4,vars:0,consts:[[3,"position"]],template:function(t,n){t&1&&(s(0,"h2"),p(1,"\u0410\u043A\u0446\u0438\u0438"),c(),C(2,R,1,1,"app-position-item",0,F)),t&2&&(r(2),b(n.positionShares()))},dependencies:[u],encapsulation:2})};export{T as PositionsComponent};
